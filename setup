#!/bin/bash

# Pre Setup
sudo steamos-readonly disable

# Install Packages
sudo pacman -Sy --noconfirm --needed --overwrite \* mc networkmanager-l2tp strongswan samba

# Configure Samba
if $(systemctl --all --type service | grep -q 'smb.service'); [ "$?" -ne 0 ]; then 
  echo "Service 'smb' does not exist. Setting up"  
  sudo smbpasswd -a deck
  sudo cp -rf /home/deck/.etc/samba/smb.conf /etc/samba/smb.conf
  sudo systemctl enable smb.service
fi

if $(systemctl is-active --quiet 'smb.service'); [ "$?" -ne 0 ]; then
  echo "Service 'smb' not running. Starting up"
  sudo systemctl start smb.service
fi

# Post Setup
sudo steamos-readonly enable
